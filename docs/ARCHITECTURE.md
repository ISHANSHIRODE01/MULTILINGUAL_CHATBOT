# System Architecture\n\n## Overview\n\nThe Multilingual Chatbot is a microservices-based application that processes audio input and provides German language responses with grammar feedback.\n\n## Architecture Diagram\n\n```\n┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐\n│   Frontend      │    │    Backend      │    │   External      │\n│   (Streamlit)   │    │   (FastAPI)     │    │   Services      │\n└─────────────────┘    └─────────────────┘    └─────────────────┘\n         │                       │                       │\n         │ HTTP Request          │                       │\n         ├──────────────────────►│                       │\n         │                       │                       │\n         │                       │ ┌─────────────────┐   │\n         │                       │ │  Orchestrator   │   │\n         │                       │ │   Workflow      │   │\n         │                       │ └─────────────────┘   │\n         │                       │          │            │\n         │                       │          ▼            │\n         │                       │ ┌─────────────────┐   │\n         │                       │ │      ASR        │   │\n         │                       │ │   (Whisper)     │   │\n         │                       │ └─────────────────┘   │\n         │                       │          │            │\n         │                       │          ▼            │\n         │                       │ ┌─────────────────┐   │\n         │                       │ │  Translation    │   │\n         │                       │ │   (MarianMT)    │   │\n         │                       │ └─────────────────┘   │\n         │                       │          │            │\n         │                       │          ▼            │\n         │                       │ ┌─────────────────┐   │ ┌─────────────┐\n         │                       │ │      LLM        │   │ │   Gemini    │\n         │                       │ │   Integration   │───┼─┤     API     │\n         │                       │ └─────────────────┘   │ └─────────────┘\n         │                       │          │            │\n         │                       │          ▼            │\n         │                       │ ┌─────────────────┐   │\n         │                       │ │    Grammar      │   │\n         │                       │ │   Checking      │   │\n         │                       │ └─────────────────┘   │\n         │                       │          │            │\n         │                       │          ▼            │\n         │                       │ ┌─────────────────┐   │\n         │                       │ │      TTS        │   │\n         │                       │ │   (pyttsx3)     │   │\n         │                       │ └─────────────────┘   │\n         │                       │          │            │\n         │ HTTP Response         │          ▼            │\n         │◄──────────────────────┤ ┌─────────────────┐   │\n         │                       │ │    Response     │   │\n         │                       │ │   Formation     │   │\n         │                       │ └─────────────────┘   │\n```\n\n## Component Details\n\n### Frontend (Streamlit)\n- **Purpose**: User interface for audio upload and result display\n- **Technology**: Streamlit web framework\n- **Features**:\n  - File upload widget\n  - Audio playback\n  - Result visualization\n  - Error handling\n\n### Backend (FastAPI)\n- **Purpose**: REST API server and request orchestration\n- **Technology**: FastAPI with uvicorn\n- **Endpoints**:\n  - `GET /health` - Health check\n  - `POST /chat_audio` - Audio processing\n\n### ASR Module (asr.py)\n- **Purpose**: Speech-to-text conversion\n- **Technology**: OpenAI Whisper\n- **Features**:\n  - Multi-language support\n  - Offline processing\n  - Confidence scoring\n\n### Translation Module (translator.py)\n- **Purpose**: Language translation and detection\n- **Technology**: MarianMT (Helsinki-NLP)\n- **Features**:\n  - EN↔DE translation\n  - Language detection\n  - Offline processing\n\n### LLM Integration (llm_helper.py)\n- **Purpose**: Generate German explanations\n- **Technology**: Google Gemini API\n- **Features**:\n  - Simple German responses\n  - Fallback to local models\n  - Error handling\n\n### Grammar Checking (feedback.py)\n- **Purpose**: Grammar correction and scoring\n- **Technology**: LanguageTool\n- **Features**:\n  - German grammar checking\n  - Correction suggestions\n  - Pronunciation scoring\n\n### TTS Module (tts.py)\n- **Purpose**: Text-to-speech conversion\n- **Technology**: pyttsx3\n- **Features**:\n  - German voice synthesis\n  - Cross-platform support\n  - File output\n\n### Orchestrator (orchestrator.py)\n- **Purpose**: Workflow coordination\n- **Features**:\n  - Component integration\n  - Error handling\n  - Response formatting\n  - Memory management\n\n## Data Flow\n\n1. **Audio Upload**: User uploads audio file via Streamlit\n2. **API Request**: Frontend sends POST request to `/chat_audio`\n3. **File Processing**: Backend saves uploaded file temporarily\n4. **Orchestration**: Orchestrator coordinates the workflow:\n   - ASR transcribes audio to text\n   - Translator detects language and translates to German\n   - LLM generates German explanation\n   - Grammar checker provides corrections\n   - TTS synthesizes German audio\n5. **Response**: Backend returns structured JSON response\n6. **Display**: Frontend shows results and plays audio\n7. **Cleanup**: Temporary files are removed\n\n## Technology Choices\n\n### Why These Technologies?\n\n- **Whisper**: Best open-source ASR, multilingual, offline\n- **MarianMT**: Free, offline translation, good quality\n- **Gemini**: Free tier, good German language support\n- **LanguageTool**: Free, comprehensive grammar checking\n- **pyttsx3**: Cross-platform, offline TTS\n- **FastAPI**: Fast, modern, automatic documentation\n- **Streamlit**: Rapid prototyping, easy deployment\n\n### Alternatives Considered\n\n- **ASR**: Google Speech-to-Text (paid), Azure Speech (paid)\n- **Translation**: Google Translate (paid), DeepL (paid)\n- **LLM**: OpenAI GPT (paid), local Llama models (resource intensive)\n- **TTS**: Google TTS (paid), Azure TTS (paid)\n\n## Scalability Considerations\n\n### Current Limitations\n- Single-threaded processing\n- Local file storage\n- No load balancing\n- Memory-based session management\n\n### Future Improvements\n- Async processing with queues\n- Cloud storage integration\n- Horizontal scaling with containers\n- Database for session persistence\n- Caching for model outputs\n\n## Security Considerations\n\n- File upload validation\n- Temporary file cleanup\n- API key protection\n- CORS configuration\n- Input sanitization\n\n## Performance Metrics\n\n- **ASR Processing**: ~2-5 seconds per minute of audio\n- **Translation**: <1 second\n- **LLM Response**: 2-5 seconds (with API)\n- **TTS Generation**: 1-3 seconds\n- **Total Pipeline**: 5-15 seconds per request